---
title: Data Is / Data Are / Data Vis
author: Sean D McAtee
date: '2020-12-30'
slug: []
categories: []
tags: []
Description: 'A visual exploration of the singular vs plural debate'
Tags: []
Categories: []
DisableComments: yes
output:
  blogdown::html_page:
    toc: false #table of contents
    toc_float: false
---

<script src="index_files/htmlwidgets/htmlwidgets.js"></script>
<link href="index_files/wordcloud2/wordcloud.css" rel="stylesheet" />
<script src="index_files/wordcloud2/wordcloud2-all.js"></script>
<script src="index_files/wordcloud2/hover.js"></script>
<script src="index_files/wordcloud2-binding/wordcloud2.js"></script>


<p>This is not be my take on the ‘Data is plural’ vs ‘Data is singular-ish’ debate, instead this is a lighthearted visual exploration of both sides of the argument. This is also my excuse to fill a post with pretty graphs.</p>
<p>The data set used for the following examples is from <a href="https://www.sciencedirect.com/science/article/pii/S2352914818301059?via%3Dihub#fig4">The open D1NAMO dataset: A multi-modal dataset for research on non-invasive type 1 diabetes management</a> by Fabien Dubosson et al. Data from the study is indexed in this <a href="https://github.com/irinagain/Awesome-CGM/wiki/Dubosson-(2018)">GitHub repo</a>. This study followed 29 individuals, 9 of which with type-1 diabetes. Continuous glucose monitoring was done with IPro2 Professional CGM Sensor for the 9 individuals with type-1 diabetes. The 20 non-diabetic group used the Bayer Contour TX glucose meter. All 29 individuals also wore a Zephyr BioHarness 3 which tracked ECG rhythm from lead I (measuring electrical vectors from right to left across the heart), they also wore an accelerometer and a pressure sensor to measure respiration rate.</p>
<p></br><br />
</br></p>
<hr />
<div id="packages-used" class="section level2">
<h2>Packages Used</h2>
<pre class="r"><code>library(tidyverse); library(ggplot2); library(magrittr);</code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v ggplot2 3.3.3     v purrr   0.3.4
## v tibble  3.0.4     v dplyr   1.0.2
## v tidyr   1.1.2     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.0</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre><code>## 
## Attaching package: &#39;magrittr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     set_names</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     extract</code></pre>
<pre class="r"><code>library(stringi); library(hms); library(tidytext)</code></pre>
</div>
<div id="loading-data" class="section level2">
<h2>Loading Data</h2>
<pre class="r"><code>workingDir &lt;- &quot;C:/Users/seand/OneDrive/Documents/D1NAMO/&quot;
cohorts &lt;- dir(workingDir)  # diabetes_subset, healthy_subset

glucose_df &lt;- tibble()
insulin_df &lt;- tibble()
food_nondiabetic_df &lt;- tibble()
food_diabetic_df &lt;- tibble()
sensor_df &lt;- tibble()
for (cohort in cohorts) {
  participants &lt;- dir(paste0(workingDir,cohort))
  tmp_cohort_glucose_df &lt;- tibble()
  if(stri_cmp_eq(cohort, &quot;diabetes_subset&quot;)){ tmp_cohort_insulin_df &lt;- tibble() }
  if(stri_cmp_eq(cohort, &quot;diabetes_subset&quot;)){ tmp_cohort_food_diabetic_df &lt;- tibble()
  } else { tmp_cohort_food_nondiabetic_df &lt;- tibble() }
  
  tmp_cohort_sensor_df &lt;- tibble()
  for (participant in participants) {
    participant_path &lt;- paste0(workingDir,cohort,&quot;/&quot;,participant)
    # Gather glucose data
    glucose_path &lt;- paste0(participant_path,&quot;/glucose.csv&quot;)
    tmp_participant_glucose_df &lt;- read_csv(glucose_path) %&gt;%
      cbind(participantID = participant, cohortGroup = cohort)
    tmp_cohort_glucose_df %&lt;&gt;% rbind(tmp_participant_glucose_df)
    # Gather insulin data
    if(stri_cmp_eq(cohort, &quot;diabetes_subset&quot;)){
      insulin_path &lt;- paste0(participant_path,&quot;/insulin.csv&quot;)
      tmp_participant_insulin_df &lt;- read_csv(insulin_path) %&gt;%
        cbind(participantID = participant, cohortGroup = cohort)
      tmp_cohort_insulin_df %&lt;&gt;% rbind(tmp_participant_insulin_df)
    }
    # Gather food data
    food_path &lt;- paste0(participant_path,&quot;/food.csv&quot;)
    tmp_participant_food_df &lt;- read_csv(food_path) %&gt;%
      cbind(participantID = participant, cohortGroup = cohort)
    if(stri_cmp_eq(cohort, &quot;diabetes_subset&quot;)){
      tmp_cohort_food_diabetic_df %&lt;&gt;% rbind(tmp_participant_food_df)
    } else { tmp_cohort_food_nondiabetic_df %&lt;&gt;% rbind(tmp_participant_food_df) }
    # Gather sensor summary data
    times_sensor_data &lt;- dir(paste0(participant_path,&quot;/sensor_data&quot;))
    sensor_summary_paths &lt;- c()
    for (time in times_sensor_data) {
      sensor_data &lt;- dir(paste0(participant_path,&quot;/sensor_data/&quot;,time))
      sensor_summary &lt;- sensor_data[which(stri_detect(sensor_data, fixed = &quot;Summary&quot;))]
      sensor_summary_paths &lt;- c(sensor_summary_paths, 
                                paste0(participant_path,&quot;/sensor_data/&quot;,
                                       time,&quot;/&quot;,sensor_summary))
    }
    tmp_participant_sensor_df &lt;- tibble()
    for (path in sensor_summary_paths) { tmp_participant_sensor_df %&lt;&gt;%
        rbind(read_csv(path)) }
    tmp_participant_sensor_df %&lt;&gt;% cbind(participantID = participant, cohortGroup = cohort)
    tmp_cohort_sensor_df %&lt;&gt;% rbind(tmp_participant_sensor_df)
  }
  glucose_df %&lt;&gt;% rbind(tmp_cohort_glucose_df)
  if(stri_cmp_eq(cohort, &quot;diabetes_subset&quot;)){ insulin_df %&lt;&gt;% rbind(tmp_cohort_insulin_df) }
  if(stri_cmp_eq(cohort, &quot;diabetes_subset&quot;)){
    food_diabetic_df %&lt;&gt;% rbind(tmp_cohort_food_diabetic_df)
  } else { food_nondiabetic_df %&lt;&gt;% rbind(tmp_cohort_food_nondiabetic_df) }
  sensor_df %&lt;&gt;% rbind(tmp_cohort_sensor_df)
}
# make date and time col for sensor_df
sensor_df %&lt;&gt;% mutate(date=as.Date(stri_extract(Time,regex=&quot;^(\\d{2}/\\d{2}/\\d{4})&quot;),
                                     format = &quot;%d/%m/%y&quot;),
                     time=parse_hms(stri_extract(Time,regex=&quot;(\\d{2}:\\d{2}:\\d{2})&quot;))) %&gt;%
  select(-Time)
# food_nondiabetic_df$calories has values that should be in $description
index_cal_desc_swap &lt;- !(stri_detect(food_nondiabetic_df$calories,regex=&quot;^\\d+$&quot;) |
                          is.na(food_nondiabetic_df$calories))
food_nondiabetic_df$description[index_cal_desc_swap] &lt;- food_nondiabetic_df$calories[index_cal_desc_swap]
food_nondiabetic_df$calories[index_cal_desc_swap] &lt;- NA
rm(tmp_cohort_glucose_df,tmp_participant_glucose_df,tmp_cohort_insulin_df,
   tmp_participant_insulin_df,tmp_cohort_food_diabetic_df,tmp_participant_food_df,
   tmp_cohort_food_nondiabetic_df,tmp_cohort_sensor_df,tmp_participant_sensor_df)</code></pre>
<pre class="r"><code>colorPalette &lt;- c(&#39;#d9a5b3&#39;, &#39;#c6d7eb&#39;, &#39;#1868ae&#39;, &#39;#9ec1b6&#39;, &#39;#9d0f40&#39;, &#39;#e0dab7&#39;)</code></pre>
<p>This is the <code>insulin_df</code> table visualized.</p>
<pre class="r"><code>library(visdat)
visdat::vis_dat(insulin_df)</code></pre>
<p><img src="index_files/figure-html/Visdat-1.png" width="672" /></p>
<p>This is a word cloud of most frequent words appearing in participants’ meal descriptions. They are grouped by cohort: diabetic and non-diabetic.</p>
<pre class="r"><code>library(wordcloud2)
# https://cran.r-project.org/web/packages/wordcloud2/vignettes/wordcloud.html

data(&quot;stop_words&quot;)

topFoods &lt;- function(df, color1, color2){
  wordFreq &lt;- unnest_tokens(tbl = df, output = word, input = description) %&gt;%
    anti_join(y = stop_words, by = &quot;word&quot;) %&gt;% 
    filter(stri_detect(word, regex = &quot;^(\\D)&quot;)) %&gt;% 
    count(word, sort = TRUE, name = &quot;freq&quot;)
  wordcloud2(wordFreq, color = c(rep(color1, 10),rep(color2, nrow(wordFreq)-10)))
}
topFoods(food_diabetic_df, colorPalette[3], colorPalette[6])</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="wordcloud2 html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"word":["bread","lettuce","potatoes","ham","salad","boiled","cheese","chicken","coffee","pizza","rice","tomatoes","yogurt","carrots","pasta","tomato","egg","asiago","beef","oil","olive","wholegrain","wine","apple","chocolate","coliflower","fish","frites","grilled","kiwi","mermelade","natural","salmon","soup","corn","cucumber","gluten","lasagne","lemon","parmesan","pastry","peas","pork","pumpkin","roast","sauce","sausage","spaguetti","white","zuchinni","baked","batata","beans","breaded","cantaloupe","cereal","champignons","cheerios","cheesse","chestnuts","chips","couscous","crackers","cream","eggplant","grapefruit","grapes","green","iceberg","leg","meat","multivitamin","pay","pills","red","salade","sandwich","sausages","sinergy","solevita","sprouts","strawberries","tablets","vinegar","alfalfa","au","babybel","baguette","beer","biscuit","black","bolognese","brie","brussels","butter","cake","caramel","carrot","cerealbar","cooked","cracker","croissant","croûte","dolmades","dough","dressing","dried","eggs","farmer","fennel","feta","flakes","flaxseeds","fried","frite","fromage","fussilli","gatorade","goat","hamburguer","harricots","hawaiian","hollandese","icre","juice","kaggi","kebab","ketchup","lime","margarita","mayonaise","meatloaf","milk","milkchocolate","mousse","nestea","package","pepper","peppers","pesto","pie","pink","plum","polenta","potatoeswith","pototates","proscuito","puff","pure","ragoût","ragûot","raisin","raisinsugar","roasted","scramble","smothie","spaetzli","spinach","spiral","steak","stewed","stracciatela","sugar","tartar","toast","tomatotes","tortellini","tuna","turkey","vegestables","vegetable","vegetables","vital","watermelon","wienerschnitzel","witholive","wrapped"],"freq":[27,17,17,15,14,13,9,9,8,8,8,8,8,7,7,7,6,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":["#1868ae","#1868ae","#1868ae","#1868ae","#1868ae","#1868ae","#1868ae","#1868ae","#1868ae","#1868ae","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7","#e0dab7"],"minSize":0,"weightFactor":6.66666666666667,"backgroundColor":"white","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>topFoods(food_nondiabetic_df, colorPalette[5], colorPalette[4])</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="wordcloud2 html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"word":["bread","chocolate","coffee","milk","cheese","cake","salad","tomatoes","carrots","juice","cereal","rice","butter","chicken","lettuce","pasta","orange","banana","ham","cookie","green","yogurt","beans","potatoes","tomato","cream","pizza","sauce","soup","apple","sugar","sandwich","bar","cookies","fried","meat","red","salmon","tea","jam","oil","brocoli","grapes","lasagna","mandarin","pepper","toast","crackers","dried","eggs","nuts","strawberry","cous","cucumber","dressing","goat","madeleine","maria","nutella","olive","peas","peppers","proteins","sausage","shaker","vanilla","white","avocado","carbonara","carrot","hamburguer","olives","onions","pork","salami","spinach","abricot","bacon","champignon","chinese","chorizo","coca","corn","cottage","courgette","croissant","egg","endives","frites","glass","hard","panallet","pear","pesto","protein","ricotta","rye","semi","shake","smoke","apricots","beef","cabbage","cola","cornflakes","cup","cupcake","de","delices","energy","fennel","fromage","fruit","fruits","grapefruit","hummus","ice","jambon","ketchup","kiwi","marrons","mini","mozarella","mozzarella","oat","parmesan","plum","smash","spatzli","tomate","tortellinis","wheat","yogourt","almonds","asiago","baked","balisto","ball","beer","beet","blueberries","bolognes","breast","camembert","candies","chalet","chantilly","chou","coffe","coliflower","comercial","courgettes","crougette","croutons","drink","finger","fish","flan","fondue","fret","gnocchis","gnocci","grain","greek","kägi","kat","kinder","kit","kitkat","mandarins","mango","mousse","omelett","pain","pepperswith","philadelphia","pie","pingui","plant","potaotes","rã","radish","roulade","spaguetti","square","squares","steamed","sti","strawberries","surimi","tuna","vinegar","waffle","watercress","à","apéro","artichoke","artichokes","asigao","balls","barre","bean","beers","berliner","beurre","biscuits","black","boiled","bounty","branche","breakfast","brie","cana","céréales","cereall","chestnuts","chickpeas","chili","chips","choucroute","coconut","coverage","cramble","cranberries","creme","crème","crepe","crêpes","curry","dark","delice","dessert","donner","duchess","duchesspotatoes","eclair","filet","financercake","flat","forest","fuet","gratin","gruyer","gruyere","herbs","honey","icecream","information","kagi","kaki","kebab","la","le","letter","limoncello","loaf","loempia","lomo","lorraine","luganiga","machego","madeleines","mais","manchego","mandarine","mashed","matcha","mayonaise","meatballs","mermelade","miel","miso","mix","mixed","natural","noodles","nougat","nuggets","oreo","pancakes","parfait","pâtes","peach","piece","pizzas","pommes","porc","post","potatoe","purée","quiche","quinoa","raspberry","raviolis","raw","roesti","rouge","salty","sausages","seaweed","slice","slide","snack","snacks","soda","spaetzle","strudel","sweet","tartlet","tasting","tiramisu","tortelliniswith","tortillas","vegetarian","vermicelles","waffel","wakame","wellington","whey","workout","yellow"],"freq":[53,43,43,39,34,24,22,22,21,21,19,19,18,18,18,18,17,16,16,15,15,15,14,14,14,13,13,13,13,12,12,11,10,10,10,10,10,10,10,9,9,8,8,8,8,8,8,7,7,7,7,7,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":["#9d0f40","#9d0f40","#9d0f40","#9d0f40","#9d0f40","#9d0f40","#9d0f40","#9d0f40","#9d0f40","#9d0f40","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6","#9ec1b6"],"minSize":0,"weightFactor":3.39622641509434,"backgroundColor":"white","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":[]}</script>
<p>This is the TF-IDF table of the meal description words. Rather than grouping IDF by ‘document’ this data is grouped by <code>quality</code>.</p>
<pre class="r"><code># TF-IDF
tfidf &lt;- function(df, group){
  unnest_tokens(df, word, description) %&gt;%
  anti_join(stop_words, by = &quot;word&quot;) %&gt;%
  filter(stri_detect(word, regex = &quot;^(\\D)&quot;)) %&gt;% 
  count(word, across({{ group }}), name = &quot;n&quot;) %&gt;%
  bind_tf_idf(word, {{ group }}, n)
}
tfidf(food_diabetic_df, &quot;quality&quot;)</code></pre>
<pre><code>## # A tibble: 258 x 6
##    word     quality            n      tf   idf  tf_idf
##    &lt;chr&gt;    &lt;ord&gt;          &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 alfalfa  Good quality       1 0.00549 1.10  0.00604
##  2 apple    Good quality       1 0.00549 0     0      
##  3 apple    Medium quality     2 0.0137  0     0      
##  4 apple    Low quality        1 0.00699 0     0      
##  5 asiago   Good quality       3 0.0165  0.405 0.00668
##  6 asiago   Medium quality     2 0.0137  0.405 0.00555
##  7 au       Good quality       1 0.00549 1.10  0.00604
##  8 babybel  Medium quality     1 0.00685 1.10  0.00752
##  9 baguette Low quality        1 0.00699 1.10  0.00768
## 10 baked    Good quality       2 0.0110  1.10  0.0121 
## # ... with 248 more rows</code></pre>
<p>This is a series of histograms that show how word count is related to IF-IDF</p>
<pre class="r"><code># hist comparison of n, tf, idf, tf-idf
tfidf_quality &lt;- tfidf(food_diabetic_df, &quot;quality&quot;)
tfidf_quality %&lt;&gt;% mutate(
  tfQuantile = ifelse(tf &gt; quantile(tf,probs = 0.5,na.rm = TRUE,names = FALSE),
                    &quot;highQuant&quot;,&quot;lowQuant&quot;),
  idfQuantile = ifelse(idf &gt; quantile(idf,probs = 0.5,na.rm = TRUE,names = FALSE),
                    &quot;highQuant&quot;,&quot;lowQuant&quot;)
  )

tfidf_hist &lt;- function(df, x, fill, binwidth, color1, color2){
  df %&gt;% ggplot( aes(x = {{ x }}, fill = {{ fill }}) ) +
    geom_histogram(binwidth = binwidth, color = &#39;white&#39;) +
    scale_fill_manual(values = c(color1, color2))
}</code></pre>
<p>This shows term frequency overylayed by the IDF upper and lower quantiles.</p>
<pre class="r"><code>tfidf_hist(tfidf_quality, `tf`, `idfQuantile`, 0.005, colorPalette[1], colorPalette[6])</code></pre>
<p><img src="index_files/figure-html/tf_idfQuantile_Food_Per_Cohort-1.png" width="672" /></p>
<p>This shows IDF overlayed by TF upper and lower quantiles.</p>
<pre class="r"><code>tfidf_hist(tfidf_quality, `idf`, `tfQuantile`, 0.08, colorPalette[4], colorPalette[2])</code></pre>
<p><img src="index_files/figure-html/idf_tfQuantile_Food_Per_Cohort-1.png" width="672" /></p>
<p>This shows TF-IDF overlayed by TF upper and lower quantiles.</p>
<pre class="r"><code>tfidf_hist(tfidf_quality, `tf_idf`, `tfQuantile`, 0.002, colorPalette[4], colorPalette[2])</code></pre>
<p><img src="index_files/figure-html/tfidf_tfQuantile_Food_Per_Cohort-1.png" width="672" /></p>
<p>This shows TF-IDF overlayed by IDF upper and lower quantiles.</p>
<pre class="r"><code>tfidf_hist(tfidf_quality, `tf_idf`, `idfQuantile`, 0.002, colorPalette[1], colorPalette[6])</code></pre>
<p><img src="index_files/figure-html/tfidf_idfQuantile_Food_Per_Cohort-1.png" width="672" /></p>
<p>This is a treemap of the top TF-IDF terms grouped by cohort.</p>
<pre class="r"><code>library(treemap)
# tree map or mosaic map
mosaic &lt;- function(df, group, plotTitle){
 df %&gt;% filter(n &gt; 3, tf_idf &gt; 0) %&gt;%
  arrange(group) %&gt;% 
  treemap::treemap(index = c(group, &quot;word&quot;),vSize = &quot;tf_idf&quot;,vColor = group,
                   type = &quot;categorical&quot;,title = plotTitle,fontsize.labels = c(0, 10),
                   fontfamily.labels = &quot;serif&quot;,
                   palette = c(colorPalette[4],colorPalette[2],colorPalette[1]),
                   align.labels = c(&quot;center&quot;, &quot;center&quot;),border.lwds = 0
                   )
}
food_diabetic_tfidf&lt;- tfidf(food_diabetic_df, &quot;quality&quot;)
food_nondiabetic_tfidf&lt;- tfidf(food_nondiabetic_df, &quot;quality&quot;)</code></pre>
<p>Diabetic Cohort</p>
<pre class="r"><code>mosaic(food_diabetic_tfidf, &quot;quality&quot;, &quot;TF-IDF&quot;)</code></pre>
<p><img src="index_files/figure-html/Treemap_Diabetic_Food_Per_Cohort-1.png" width="672" /></p>
<p>Non Diabetic Cohort</p>
<pre class="r"><code>mosaic(food_nondiabetic_tfidf, &quot;quality&quot;, &quot;TF-IDF&quot;)</code></pre>
<p><img src="index_files/figure-html/Treemap_NonDiabetic_Food_Per_Cohort-1.png" width="672" /></p>
<p>This shows the percent of meals that are high, medium, or low quality grouped by cohort.</p>
<pre class="r"><code># amount of meals for each quality, per cohort
foodQualityMatrix &lt;- matrix(c(count(food_nondiabetic_df, quality)$n,
                              count(food_diabetic_df, quality)$n), ncol = 2)
colnames(foodQualityMatrix) &lt;- c(&quot;nondiabetic&quot;, &quot;diabetic&quot;)

# arrange good, med, low
foodQualityMatrix &lt;- rbind(foodQualityMatrix[1,],foodQualityMatrix[3,],foodQualityMatrix[2,])
rownames(foodQualityMatrix) &lt;- c(&quot;Good quality&quot;, &quot;Medium quality&quot;, &quot;Low quality&quot;)
par(mar=c(5,6,2,1))

apply(foodQualityMatrix, 2, function(x){x*100/sum(x)}) %&gt;%
  barplot(horiz = TRUE,col = c(colorPalette[4],colorPalette[2],colorPalette[1]),
    legend.text = TRUE,args.legend = list(x = &quot;topleft&quot;, inset=c(0.10,-0.18),
                                          ncol = 4, bty=&#39;n&#39;, xpd = TRUE),
    las = 1,border = &#39;white&#39;,xlab = &#39;Percent of Meals by Quality&#39;
          )</code></pre>
<p><img src="index_files/figure-html/Stacked_Bar_Food_Quality_Cohort-1.png" width="672" /></p>
<p>This shows the distributions of Continuous Glucose Monitor (CGM) Measurements for all 9 diabetic participants.</p>
<pre class="r"><code>glucose_df %&gt;% filter(type == &quot;cgm&quot;) %&gt;% ggplot(aes(x=participantID, y=glucose)) +
  geom_violin(trim = FALSE, fill=colorPalette[2], color=colorPalette[3]) +
  geom_boxplot(width=0.06, fill=colorPalette[1]) +
  labs(x = &quot;participantID&quot;, y = &quot;Blood Glucose [mmol/L]&quot;) +
  ggtitle(&quot;Participant Distributions of CGM Measurements&quot;) +
  geom_hline(yintercept=11.1, linetype=&#39;dashed&#39;, color=colorPalette[5], size=0.6) +
  annotate(&quot;text&quot;, x=&quot;009&quot;, y=11.1, label=&quot;High&quot;, color = colorPalette[5], vjust=-0.5) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="index_files/figure-html/Violen_Glucose_Cohort-1.png" width="672" /></p>
<p>This shows the distribution of diabetic participant 006 CGM, heart rate, and breathing rate on 2014-10-02.</p>
<pre class="r"><code>library(ggridges)
# https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html
glucose_df %&gt;%
  filter(type == &quot;cgm&quot;, participantID == &quot;006&quot;, date == unique(date)[2]) %&gt;%
  mutate(time=stri_extract(as.character(time),regex=&quot;^(\\d{2})&quot;)) %&gt;% 
  ggplot(aes(x=glucose, y=time, fill=stat(x))) +
  geom_density_ridges_gradient(scale=1.3, rel_min_height=0.01) +
  scale_fill_continuous(name=&quot;Glucose&quot;, low=colorPalette[1], high=colorPalette[5]) +
  labs(x=&quot;Blood Glucose [mmol/L]&quot;, y=&quot;Hour&quot;) +
  ggtitle(&#39;Participant 006\nHourly CGM Distribution\n2014-10-02&#39;) +
  geom_vline(xintercept=11.1, linetype=&#39;dashed&#39;, color=colorPalette[5], size=0.6) +
  annotate(&quot;text&quot;, x=11.1, y=&quot;06&quot;, label=&quot;High&quot;, color=colorPalette[5], hjust=-0.4) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="index_files/figure-html/Ridgeline_CGM-1.png" width="672" /></p>
<pre class="r"><code># Heart Rate
sensor_df %&gt;%
  select(HR, BR, Activity, participantID, cohortGroup, date, time) %&gt;%
  mutate(time = stri_extract(as.character(time), regex = &quot;^(\\d{2})&quot;)) %&gt;%
  filter(participantID == &quot;006&quot;, cohortGroup == &quot;diabetes_subset&quot;,
         date == unique(date)[2], HR &gt; 0, BR &gt; 0) %&gt;% 
  ggplot(aes(x=HR, y=time, fill=stat(x))) +
  geom_density_ridges_gradient(scale=1.3, rel_min_height=0.01) +
  scale_fill_continuous(name=&quot;Heart Rate&quot;, low=colorPalette[2], high=colorPalette[4]) +
  labs(x=&quot;Heart Rate [bpm]&quot;, y=&quot;Hour&quot;) +
  ggtitle(&quot;Participant 006\nHourly Heart Rate Distribution\n2014-10-02&quot;) +
  theme_minimal()</code></pre>
<p><img src="index_files/figure-html/Ridgeline_CGM-2.png" width="672" /></p>
<pre class="r"><code># Breathing Rate
sensor_df %&gt;%
  select(HR, BR, Activity, participantID, cohortGroup, date, time) %&gt;%
  mutate(time = stri_extract(as.character(time), regex = &quot;^(\\d{2})&quot;)) %&gt;%
  filter(participantID == &quot;006&quot;, cohortGroup == &quot;diabetes_subset&quot;,
         date == unique(date)[2], HR &gt; 0, BR &gt; 0) %&gt;% 
  ggplot(aes(x=BR, y=time, fill=stat(x))) +
  geom_density_ridges_gradient(scale=1.3, rel_min_height=0.01) +
  scale_fill_continuous(name=&quot;Breathing Rate&quot;, low=colorPalette[6], high=colorPalette[3]) +
  labs(x=&quot;Breathing Rate [breaths/min]&quot;, y=&quot;Hour&quot;) +
  ggtitle(&quot;Participant 006\nHourly Breathing Rate Distribution\n2014-10-02&quot;) +
  theme_minimal()</code></pre>
<p><img src="index_files/figure-html/Ridgeline_CGM-3.png" width="672" /></p>
<p>This shows a radar graph (aka spider graph) of diabetic participant 006 CGM on 2014-10-02.</p>
<pre class="r"><code>library(fmsb)
# https://cran.r-project.org/web/packages/fmsb/fmsb.pdf
# radar cgm for one individual
glucose_df_wide &lt;- 
  filter(glucose_df, type == &quot;cgm&quot;, participantID == &quot;006&quot;, date == unique(date)[2]) %&gt;%
  mutate(time = stri_extract(as.character(time),regex=&quot;^(\\d{2})&quot;)) %&gt;%
  group_by(time) %&gt;% 
  summarise(glucose = mean(glucose)) %&gt;%
  pivot_wider(names_from = time, values_from = glucose)

rbind(
  rep(16,ncol(glucose_df_wide)),
  rep(4,ncol(glucose_df_wide)),
  glucose_df_wide[,order(ncol(glucose_df_wide):1)]
) %&gt;% radarchart(axistype=1, seg=3, plwd=1, centerzero=FALSE, cglcol=colorPalette[1], cglty=1,
                 axislabcol=colorPalette[5], caxislabels=seq(4,16,4), vlcex=0.8,
                 title = &quot;Participant 006\nHourly Mean Glucose\n2014-10-02&quot;
                 )</code></pre>
<p><img src="index_files/figure-html/Radar_Single_Participant_CGM-1.png" width="672" /></p>
</div>
